document.addEventListener("DOMContentLoaded",function(){(function(){const s=document.querySelector(".email-list"),w=[].slice.call(document.querySelectorAll(".email-list-item")),i=[].slice.call(document.querySelectorAll(".email-list-item-input")),d=document.querySelector(".app-email-view-content"),m=document.querySelector(".email-filters"),u=[].slice.call(document.querySelectorAll(".email-filter-folders li")),C=document.querySelector(".email-editor"),x=document.querySelector(".app-email-sidebar"),A=document.querySelector(".app-overlay"),H=document.querySelector(".email-reply-editor"),p=[].slice.call(document.querySelectorAll(".email-list-item-bookmark")),a=document.getElementById("email-select-all"),v=document.querySelector(".email-search-input"),g=document.querySelector(".email-compose-toggle-cc"),h=document.querySelector(".email-compose-toggle-bcc"),P=document.querySelector(".app-email-compose"),S=document.querySelector(".email-list-delete"),y=document.querySelector(".email-list-read"),f=document.querySelector(".email-list-empty"),k=document.querySelector(".email-refresh"),_=document.getElementById("app-email-view"),b=[].slice.call(document.querySelectorAll(".email-filter-folders li")),L=[].slice.call(document.querySelectorAll(".email-list-item-actions li"));if(s&&new PerfectScrollbar(s,{wheelPropagation:!1,suppressScrollX:!0}),m&&new PerfectScrollbar(m,{wheelPropagation:!1,suppressScrollX:!0}),d&&new PerfectScrollbar(d,{wheelPropagation:!1,suppressScrollX:!0}),C&&new Quill(".email-editor",{modules:{toolbar:".email-editor-toolbar"},placeholder:"Message... ",theme:"snow"}),H&&new Quill(".email-reply-editor",{modules:{toolbar:".email-reply-toolbar"},placeholder:"Write your message... ",theme:"snow"}),p&&p.forEach(l=>{l.addEventListener("click",t=>{let e=t.currentTarget.parentNode.parentNode.parentNode,r=e.getAttribute("data-starred");t.stopPropagation(),r?e.removeAttribute("data-starred"):e.setAttribute("data-starred","true")})}),a&&a.addEventListener("click",l=>{l.currentTarget.checked?i.forEach(t=>t.checked=1):i.forEach(t=>t.checked=0)}),i&&i.forEach(l=>{l.addEventListener("click",t=>{t.stopPropagation();let e=0;i.forEach(r=>{r.checked&&e++}),e<i.length?e==0?a.indeterminate=!1:a.indeterminate=!0:e==i.length?(a.indeterminate=!1,a.checked=!0):a.indeterminate=!1})}),v&&v.addEventListener("keyup",l=>{let t=l.currentTarget.value.toLowerCase(),e={},r=document.querySelector(".email-filter-folders .active").getAttribute("data-target");r!="inbox"?e=[].slice.call(document.querySelectorAll(".email-list-item[data-"+r+'="true"]')):e=[].slice.call(document.querySelectorAll(".email-list-item")),e.forEach(o=>{let T=o.textContent.toLowerCase();t?-1<T.indexOf(t)?o.classList.add("d-block"):o.classList.add("d-none"):o.classList.remove("d-none")})}),u.forEach(l=>{l.addEventListener("click",t=>{let e=t.currentTarget,r=e.getAttribute("data-target");x.classList.remove("show"),A.classList.remove("show"),Helpers._removeClass("active",u),e.classList.add("active"),w.forEach(o=>{r=="inbox"||o.hasAttribute("data-"+r)?(o.classList.add("d-block"),o.classList.remove("d-none")):(o.classList.add("d-none"),o.classList.remove("d-block"))})})}),h&&h.addEventListener("click",l=>{Helpers._toggleClass(document.querySelector(".email-compose-bcc"),"d-block","d-none")}),g&&g.addEventListener("click",l=>{Helpers._toggleClass(document.querySelector(".email-compose-cc"),"d-block","d-none")}),P.addEventListener("hidden.bs.modal",l=>{document.querySelector(".email-editor .ql-editor").innerHTML="",$("#emailContacts").val(""),E()}),S&&S.addEventListener("click",l=>{i.forEach(e=>{e.checked&&e.parentNode.closest("li.email-list-item").remove()}),a.indeterminate=!1,a.checked=!1;var t=document.querySelectorAll(".email-list-item");t.length==0&&f.classList.remove("d-none")}),y&&y.addEventListener("click",l=>{i.forEach(t=>{if(t.checked){t.checked=!1,t.parentNode.closest("li.email-list-item").classList.add("email-marked-read");let e=t.parentNode.closest("li.email-list-item").querySelector(".email-list-item-actions li");Helpers._hasClass("email-read",e)&&(e.classList.remove("email-read"),e.classList.add("email-unread"),e.querySelector("i").classList.remove("bx-envelope-open"),e.querySelector("i").classList.add("bx-envelope"))}}),a.indeterminate=!1,a.checked=!1}),k&&s){let l=$(".email-list"),t=new PerfectScrollbar(s,{wheelPropagation:!1,suppressScrollX:!0});k.addEventListener("click",e=>{l.block({message:'<div class="spinner-border text-primary" role="status"></div>',timeout:1e3,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#000",opacity:.1},onBlock:function(){t.settings.suppressScrollY=!0},onUnblock:function(){t.settings.suppressScrollY=!1}})})}let q=$(".email-earlier-msgs");q.length&&q.on("click",function(){let l=$(this);l.parents().find(".email-card-last").addClass("hide-pseudo"),l.next(".email-card-prev").slideToggle(),l.remove()});let n=$("#emailContacts");function E(){if(n.length){let l=function(t){return t.id?"<div class='d-flex flex-wrap align-items-center'><div class='avatar avatar-xs me-2 w-px-20 h-px-20'><img src='"+assetsPath+"img/avatars/"+$(t.element).data("avatar")+"' alt='avatar' class='rounded-circle' /></div>"+t.text+"</div>":t.text};n.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:n.parent(),closeOnSelect:!1,templateResult:l,templateSelection:l,escapeMarkup:function(t){return t}})}}E();let c=$(".app-email-view-content");c.find(".scroll-to-reply").on("click",function(){c[0].scrollTop===0&&c.animate({scrollTop:c[0].scrollHeight},1500)}),b&&b.forEach(l=>{l.addEventListener("click",t=>{_.classList.remove("show")})}),L&&L.forEach(l=>{l.addEventListener("click",t=>{t.stopPropagation();let e=t.currentTarget;if(Helpers._hasClass("email-delete",e)){e.parentNode.closest("li.email-list-item").remove();var r=document.querySelectorAll(".email-list-item");r.length==0&&f.classList.remove("d-none")}else Helpers._hasClass("email-read",e)?(e.parentNode.closest("li.email-list-item").classList.add("email-marked-read"),Helpers._toggleClass(e,"email-read","email-unread"),Helpers._toggleClass(e.querySelector("i"),"bx-envelope-open","bx-envelope")):Helpers._hasClass("email-unread",e)&&(e.parentNode.closest("li.email-list-item").classList.remove("email-marked-read"),Helpers._toggleClass(e,"email-read","email-unread"),Helpers._toggleClass(e.querySelector("i"),"bx-envelope-open","bx-envelope"))})})})()});
