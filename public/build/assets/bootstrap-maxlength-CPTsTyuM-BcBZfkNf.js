(function(r){r.event.special.destroyed||(r.event.special.destroyed={remove:function(s){s.handler&&s.handler()}}),r.fn.extend({maxlength:function(s,d){var w=r("body"),C={showOnReady:!1,alwaysShow:!0,threshold:0,warningClass:"small form-text text-muted",limitReachedClass:"small form-text text-danger",limitExceededClass:"",separator:" / ",preText:"",postText:"",showMaxLength:!0,placement:"bottom-right-inside",message:null,showCharsTyped:!0,validate:!1,utf8:!1,appendToParent:!1,twoCharLinebreak:!0,customMaxAttribute:null,customMaxClass:"overmax",allowOverMax:!1,zIndex:1099};r.isFunction(s)&&!d&&(d=s,s={}),s=r.extend(C,s);function l(a){var t=a.charCodeAt();return t?t<128?1:t<2048?2:3:0}function u(a){return a.split("").map(l).concat(0).reduce(function(t,e){return t+e})}function m(a){var t=a.val();s.twoCharLinebreak?t=t.replace(/\r(?!\n)|\n(?!\r)/g,`\r
`):t=t.replace(/(?:\r\n|\r|\n)/g,`
`);var e=0;return s.utf8?e=u(t):e=t.length,a.prop("type")==="file"&&a.val()!==""&&(e-=12),e}function b(a,t){var e=a.val();if(s.twoCharLinebreak&&(e=e.replace(/\r(?!\n)|\n(?!\r)/g,`\r
`),e[e.length-1]===`
`&&(t-=e.length%2)),s.utf8){for(var n=e.split("").map(l),o=0,c=u(e)-t;o<c;o+=n.pop());t-=t-n.length}a.val(e.substr(0,t))}function y(a,t,e){var n=!0;return!s.alwaysShow&&e-m(a)>t&&(n=!1),n}function g(a,t){var e=t-m(a);return e}function p(a,t){t.css({display:"block"}),a.trigger("maxlength.shown")}function k(a,t){s.alwaysShow||(t.css({display:"none"}),a.trigger("maxlength.hidden"))}function x(a,t,e){var n="";return s.message?typeof s.message=="function"?n=s.message(a,t):n=s.message.replace("%charsTyped%",e).replace("%charsRemaining%",t-e).replace("%charsTotal%",t):(s.preText&&(n+=s.preText),s.showCharsTyped?n+=e:n+=t-e,s.showMaxLength&&(n+=s.separator+t),s.postText&&(n+=s.postText)),n}function v(a,t,e,n){n&&(n.html(x(t.val(),e,e-a)),a>0?y(t,s.threshold,e)?p(t,n.removeClass(s.limitReachedClass+" "+s.limitExceededClass).addClass(s.warningClass)):k(t,n):s.limitExceededClass?a===0?p(t,n.removeClass(s.warningClass+" "+s.limitExceededClass).addClass(s.limitReachedClass)):p(t,n.removeClass(s.warningClass+" "+s.limitReachedClass).addClass(s.limitExceededClass)):p(t,n.removeClass(s.warningClass).addClass(s.limitReachedClass))),s.customMaxAttribute&&(a<0?t.addClass(s.customMaxClass):t.removeClass(s.customMaxClass))}function M(a){var t=a[0];return r.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},a.offset())}function T(a,t){if(!(!a||!t)){var e=["top","bottom","left","right","position"],n={};r.each(e,function(o,c){var i=s.placement[c];typeof i<"u"&&(n[c]=i)}),t.css(n)}}function h(a,t){var e=M(a);if(r.type(s.placement)==="function"){s.placement(a,t,e);return}if(r.isPlainObject(s.placement)){T(s.placement,t);return}var n=a.outerWidth(),o=t.outerWidth(),c=t.width(),i=t.height();switch(s.appendToParent&&(e.top-=a.parent().offset().top,e.left-=a.parent().offset().left),s.placement){case"bottom":t.css({top:e.top+e.height,left:e.left+e.width/2-c/2});break;case"top":t.css({top:e.top-i,left:e.left+e.width/2-c/2});break;case"left":t.css({top:e.top+e.height/2-i/2,left:e.left-c});break;case"right":t.css({top:e.top+e.height/2-i/2,left:e.left+e.width});break;case"bottom-right":t.css({top:e.top+e.height,left:e.left+e.width});break;case"top-right":t.css({top:e.top-i,left:e.left+n});break;case"top-left":t.css({top:e.top-i,left:e.left-o});break;case"bottom-left":t.css({top:e.top+a.outerHeight(),left:e.left-o});break;case"centered-right":t.css({top:e.top+i/2,left:e.left+n-o-3});break;case"bottom-right-inside":t.css({top:e.top+e.height,left:e.left+e.width-o});break;case"top-right-inside":t.css({top:e.top-i,left:e.left+n-o});break;case"top-left-inside":t.css({top:e.top-i,left:e.left});break;case"bottom-left-inside":t.css({top:e.top+a.outerHeight(),left:e.left});break}}function f(a){var t=a.attr("maxlength")||s.customMaxAttribute;if(s.customMaxAttribute&&!s.allowOverMax){var e=a.attr(s.customMaxAttribute);(!t||e<t)&&(t=e)}return t||(t=a.attr("size")),t}return this.each(function(){var a=r(this),t,e;r(window).resize(function(){e&&h(a,e)});function n(){var o=x(a.val(),t,"0");t=f(a),e||(e=r('<span class="bootstrap-maxlength"></span>').css({display:"none",position:"absolute",whiteSpace:"nowrap",zIndex:s.zIndex}).html(o)),a.is("textarea")&&(a.data("maxlenghtsizex",a.outerWidth()),a.data("maxlenghtsizey",a.outerHeight()),a.mouseup(function(){(a.outerWidth()!==a.data("maxlenghtsizex")||a.outerHeight()!==a.data("maxlenghtsizey"))&&h(a,e),a.data("maxlenghtsizex",a.outerWidth()),a.data("maxlenghtsizey",a.outerHeight())})),s.appendToParent?(a.parent().append(e),a.parent().css("position","relative")):w.append(e);var c=g(a,f(a));v(c,a,t,e),h(a,e)}s.showOnReady?a.ready(function(){n()}):a.focus(function(){n()}),a.on("maxlength.reposition",function(){h(a,e)}),a.on("destroyed",function(){e&&e.remove()}),a.on("blur",function(){e&&!s.showOnReady&&e.remove()}),a.on("input",function(){var o=f(a),c=g(a,o),i=!0;return s.validate&&c<0?(b(a,o),i=!1):v(c,a,t,e),i})})}})})(jQuery);
